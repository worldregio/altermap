---
title: "Polarisation - France"
subtitle: "Source : Claude Grasland & al., 2010,  Projet Eurobroadmap, UP1, UP7, U. Rouen, U. Lyon "
author: "Claude Grasland"
date: "2025-08-26"
date-format: iso
lang: fr
format:
  html:
    embed-resources: true
    theme: 
      light: minty    
      dark: solar
    smooth-scroll: true
    fontsize: 0.9em
    toc: true
    toc-depth: 2
    toc-title: "."
    css: styles.css
    crossrefs-hover: false
execute:
  warning: false
  message: false 
  cache: false   
  echo: false
knitr:
  opts_chunk:
    out.width: "100%"
editor_options: 
  chunk_output_type: console
editor: 
  markdown: 
    wrap: 72
---



On propose ici un mini-atlas des principaux résultats de l'enquête obtenus dans chacun des pays.

```{r}
library(dplyr)
library(sf)
library(mapsf)
library(knitr)
library(questionr)
library(ggplot2)
library(ggrepel)
```


```{r}
mysel <- "FRA"
mylabel <- "France"

## Données
don <- readRDS("data/ebm/survey/ebm2010_V2.RDS")
don$Code<-as.character(don$Code)
sel <- don %>% filter(substr(Code,1,3)==mysel)

## Attrep
AR <-readRDS("data/ebm/survey/ebm2010_attrep.RDS")
ARsel <- AR %>% filter(substr(Code,1,3)==mysel)

## Fonds de carte
sta <- readRDS("data/ebm/geom/ebm_states.RDS")
cit <- readRDS("data/ebm/geom/ebm_cities.RDS")
```


## (1) Echantillonage

Nous présentons tout d'abord les principales caractéristiques de l'échantillon en termes de lieux, disciplines, âge et sexe.

### Lieux d'enquête

```{r}
t<- table(as.character(sel$G_City_name), useNA = "ifany")
kable(freq(t,cum = F,valid = T,total = T, digits=1), caption = "Villes ou régions dans lesquelles l'enquête a été réalisée")
```

### Domaines d'études

```{r}
sel$G_Study<-as.factor(sel$G_Study)
levels(sel$G_Study) <- c("Art, Lettres, Cinéma", 
                         "Economie, Gestion",
                         "Sciences exactes, Ingénieurs",
                         "Santé, Médecine",
                         "Sciences Politiques, Droit",
                         "Sciences Humaines et Sociales")
t<-table(sel$G_Study, useNA = "ifany")
kable(freq(t,cum = F,valid = T,total = T, digits=1), caption = "Répartition par domaines d'étude")
```


### Sexe

```{r}
sel$A1_Gender<-as.factor(sel$A1_Gender)
levels(sel$A1_Gender) <- c("Femme","Homme")
t<-table(sel$A1_Gender, useNA = "ifany")
kable(freq(t,cum = F,valid = T,total = T, digits=1), caption = "Répartition par sexe")
```


### Âge

```{r}
age<-cut(sel$A2_Age,breaks=c(15,18,19,20,21,22,23,24,100),include.lowest = T)
levels(age) <-c("18 ans et -","19 ans","20 ans","21 ans","22 ans","23 ans","24 ans", "25 ans et +")
t<-table(age,useNA = "ifany")
kable(freq(t,cum = F,valid = T,total = T, digits=1), caption = "Distribution des âges")
```


## (2) Pays attractifs et répulsifs


```{r}
tab<-ARsel %>% filter(type =="STA", is.na(state)==F, state != mysel)
nbrep <-length(unique(tab$Code))
kno <- tab %>% group_by(state) %>% count() %>% arrange(-n) %>% rename(kno=n, iso3=state)
att<-tab %>% filter(opi==1) %>% group_by(state) %>% count() %>% arrange(-n) %>% rename(att=n, iso3=state)
rep<-tab %>% filter(opi==-1) %>% group_by(state) %>% count() %>% arrange(-n) %>% rename(rep=n, iso3=state)
res <-sta %>% select(-n, -region,-continent) %>%  mutate(tot=nbrep) %>% left_join(kno) %>% left_join(att) %>% left_join(rep) %>% arrange(-kno)
res$tot[is.na(res$tot)]<-0
res$kno[is.na(res$kno)]<-0
res$att[is.na(res$att)]<-0
res$rep[is.na(res$rep)]<-0
res$sal <-100*res$kno/res$tot
res$asy <- (res$att-res$rep)/res$kno

```


### Saillance

Quels pays ont été les plus cités, quelle qu'en soit la raison ?


```{r}
sal <- res %>% st_drop_geometry() %>% mutate(rang = rank(-kno), sal = 100*kno/tot) %>% 
                                      select(rang,
                                             iso3,
                                             name,
                                             tot,
                                             kno,
                                             sal)
kable(head(sal, 20), 
      caption = paste(mylabel, " : 20 pays les plus cités par les étudiants (Enquête EuroBroadmap 2009)"),
      col.names = c("rang","code","pays","échantillon","réponses","proportion (%)"), digits=c(0,0,0,0,0,1))
```




```{r}
mf_map(res, col="gray90")
mf_map(res, type = "prop", 
            var="kno", 
            col="gray30",
            border="white",
            lwd=0.2,
            leg_pos= "topleft",
            leg_title = "Nb. réponses",
            inches = 0.11,
            add=T)
mf_layout(title = paste(mylabel, " : pays les plus cités par les étudiants"),
           frame = T,
           arrow=F,
           scale=F,
          credits = "(c) Grasland C., 2025 - Source : Enquête EuroBroadMap 2009-2010")
          
```


### Attraction

Quels pays ont été les plus cités comme lmieux où les étudiants souhaiteraient vivre dans un future proche ?


```{r}
att <- res %>% st_drop_geometry() %>% mutate(rang = rank(-att), sal = 100*att/tot) %>% 
                                      select(rang,
                                             iso3,
                                             name,
                                             tot,
                                             att,
                                             sal) %>%
                                        arrange(rang)
kable(head(att, 20), 
      caption = paste(mylabel, " : 20 pays les plus attractifs pour  les étudiants (Enquête EuroBroadmap 2009)"),
      col.names = c("rang","code","pays","échantillon","réponses","proportion (%)"), digits=c(0,0,0,0,0,1))
```


```{r}
mf_map(res, col="gray90")
mf_map(res, type = "prop", 
            var="att", 
            col="blue",
            border="white",
            lwd=0.2,
            leg_pos= "topleft",
            leg_title = "Nb. réponses",
            inches = 0.11,
            add=T)
mf_layout(title = paste(mylabel, " : pays les plus attractifs pour les étudiants"),
           frame = T,
           arrow=F,
           scale=F,
          credits = "(c) Grasland C., 2025 - Source : Enquête EuroBroadMap 2009-2010")
          
```



### Répulsion

Quels pays ont été les plus cités comme lieux où les étudiants ne souhaiteraient pas vivre dans un future proche ?


```{r}
att <- res %>% st_drop_geometry() %>% mutate(rang = rank(-rep), sal = 100*rep/tot) %>% 
                                      select(rang,
                                             iso3,
                                             name,
                                             tot,
                                             rep,
                                             sal) %>%
                                        arrange(rang)
kable(head(att, 20), 
      caption = paste(mylabel, " : 20 pays les plus répulsifs pour  les étudiants (Enquête EuroBroadmap 2009)"),
      col.names = c("rang","code","pays","échantillon","réponses","proportion (%)"), digits=c(0,0,0,0,0,1))
```


```{r}
mf_map(res, col="gray90")
mf_map(res, type = "prop", 
            var="rep", 
            col="red",
            border="white",
            lwd=0.2,
            leg_pos= "topleft",
            leg_title = "Nb. réponses",
            inches = 0.11,
            add=T)
mf_layout(title = paste(mylabel, " : pays les plus répulsifs pour les étudiants"),
           frame = T,
           arrow=F,
           scale=F,
          credits = "(c) Grasland C., 2025 - Source : Enquête EuroBroadMap 2009-2010")
          
```


### Synthèse 


```{r}
res2 <- st_drop_geometry(res) %>% filter(sal > 1) 
ggplot(res2, aes(x=sal,y=asy)) + 
       geom_point() +
       geom_label_repel(aes(label=iso3),cex=4) +
       scale_x_log10("Saillance (%)") +
       scale_y_continuous("Indice d'attraction-répulsion") +
      ggtitle(paste(mylabel, ": synthèse des perceptions des pays du Monde"),
      subtitle = "(c) Grasland C., 2025 - Source : Enquête EuroBroadMap 2009-2010") +
      theme_light()

```




```{r}
mybreaks <- c(-1,-0.6, -0.2,0.2,0.6,1)
mypal<-c("red","pink","lightyellow","lightblue","blue")
mf_map(res, col="gray90")
mf_map(res, type = "prop_choro", 
            var=c("sal","asy"), 
            border="black",
            lwd=0.5,
            breaks=mybreaks,
            pal=mypal,
            leg_pos= c("topleft", "topright"),
            leg_title = c("Saillance (%)","Attraction-Répulsion."),
            inches = 0.11,
            add=T)
mf_layout(title = paste(mylabel, " : synthèse des perceptions des pays du Monde"),
           frame = T,
           arrow=F,
           scale=F,
          credits = "(c) Grasland C., 2025 - Source : Enquête EuroBroadMap 2009-2010")
          
```


## (3) Villes attractives et répulsives


```{r}
tab<-ARsel %>% filter(type =="CIT", is.na(city)==F, state != mysel)
nbrep <-length(unique(tab$Code))
kno <- tab %>% group_by(city) %>% count() %>% arrange(-n) %>% rename(kno=n)
att<-tab %>% filter(opi==1) %>% group_by(city) %>% count() %>% arrange(-n) %>% rename(att=n)
rep<-tab %>% filter(opi==-1) %>% group_by(city) %>% count() %>% arrange(-n) %>% rename(rep=n)
res <-cit %>%  mutate(tot=nbrep) %>% left_join(kno) %>% left_join(att) %>% left_join(rep) %>% arrange(-kno)
res$tot[is.na(res$tot)]<-0
res$kno[is.na(res$kno)]<-0
res$att[is.na(res$att)]<-0
res$rep[is.na(res$rep)]<-0
res$sal <-100*res$kno/res$tot
res$asy <- (res$att-res$rep)/res$kno

```


### Saillance

Quels villes ont été les plus citées, quelle qu'en soit la raison ?


```{r}
sal <- res %>% st_drop_geometry() %>% mutate(rang = rank(-kno), sal = 100*kno/tot) %>% 
                                      select(rang,
                                             name,
                                             state,
                                             tot,
                                             kno,
                                             sal)
kable(head(sal, 20), 
      caption = paste(mylabel, " : 20 villes les plus citées par les étudiants (Enquête EuroBroadmap 2009)"),
      col.names = c("rang","ville","pays","échantillon","réponses","proportion (%)"), digits=c(0,0,0,0,0,1))
```




```{r}
mf_map(sta, col="gray90")
mf_map(res, type = "prop", 
            var="kno", 
            col="gray30",
            border="white",
            lwd=0.2,
            leg_pos= "topleft",
            leg_title = "Nb. réponses",
            inches = 0.11,
            add=T)
mf_layout(title = paste(mylabel, " : villes les plus citées par les étudiants"),
           frame = T,
           arrow=F,
           scale=F,
          credits = "(c) Grasland C., 2025 - Source : Enquête EuroBroadMap 2009-2010")
          
```


### Attraction

Quels villes ont été les plus citées comme lieux où les étudiants souhaiteraient vivre dans un futur proche ?


```{r}
att <- res %>% st_drop_geometry() %>% mutate(rang = rank(-att), sal = 100*att/tot) %>% 
                                      select(rang,
                                             name,
                                             state,
                                             tot,
                                             att,
                                             sal) %>%
                                        arrange(rang)
kable(head(att, 20), 
      caption = paste(mylabel, " : 20 villes les plus attractives pour  les étudiants (Enquête EuroBroadmap 2009)"),
      col.names = c("rang","ville","pays","échantillon","réponses","proportion (%)"), digits=c(0,0,0,0,0,1))
```


```{r}
mf_map(sta, col="gray90")
mf_map(res, type = "prop", 
            var="att", 
            col="blue",
            border="white",
            lwd=0.2,
            leg_pos= "topleft",
            leg_title = "Nb. réponses",
            inches = 0.11,
            add=T)
mf_layout(title = paste(mylabel, " : villes les plus attractives pour les étudiants"),
           frame = T,
           arrow=F,
           scale=F,
          credits = "(c) Grasland C., 2025 - Source : Enquête EuroBroadMap 2009-2010")
          
```



### Répulsion

Quels villes ont été les plus citées comme lieux où les étudiants ne souhaiteraient pas vivre dans un futur proche ?


```{r}
att <- res %>% st_drop_geometry() %>% mutate(rang = rank(-rep), sal = 100*rep/tot) %>% 
                                      select(rang,
                                             name,
                                             state,
                                             tot,
                                             rep,
                                             sal) %>%
                                        arrange(rang)
kable(head(att, 20), 
      caption = paste(mylabel, " : 20 villes les plus répulsives pour  les étudiants (Enquête EuroBroadmap 2009)"),
      col.names = c("rang","ville","pays","échantillon","réponses","proportion (%)"), digits=c(0,0,0,0,0,1))
```


```{r}
mf_map(sta, col="gray90")
mf_map(res, type = "prop", 
            var="rep", 
            col="red",
            border="white",
            lwd=0.2,
            leg_pos= "topleft",
            leg_title = "Nb. réponses",
            inches = 0.11,
            add=T)
mf_layout(title = paste(mylabel, " : villes les plus répulsives pour les étudiants"),
           frame = T,
           arrow=F,
           scale=F,
          credits = "(c) Grasland C., 2025 - Source : Enquête EuroBroadMap 2009-2010")
          
```


### Synthèse 


```{r}
res2 <- st_drop_geometry(res) %>% filter(sal > 1) 
ggplot(res2, aes(x=sal,y=asy)) + 
       geom_point() +
       geom_label_repel(aes(label=name),cex=3) +
       scale_x_log10("Saillance (%)") +
       scale_y_continuous("Indice d'attraction-répulsion") +
      ggtitle(paste(mylabel, ": synthèse des perceptions des villes du Monde"),
      subtitle = "(c) Grasland C., 2025 - Source : Enquête EuroBroadMap 2009-2010") +
      theme_light()

```




```{r}
mybreaks <- c(-1,-0.6, -0.2,0.2,0.6,1)
mypal<-c("red","pink","lightyellow","lightblue","blue")
mf_map(sta, col="gray90",bg="lightblue")
mf_map(res, type = "prop_choro", 
            var=c("sal","asy"), 
            border="black",
            lwd=0.5,
            breaks=mybreaks,
            pal=mypal,
            leg_pos= c("topleft", "topright"),
            leg_title = c("Saillance (%)","Attraction-Répulsion."),
            inches = 0.11,
            add=T)
mf_layout(title = paste(mylabel, " : synthèse des perceptions des villes du Monde"),
           frame = T,
           arrow=F,
           scale=F,
          credits = "(c) Grasland C., 2025 - Source : Enquête EuroBroadMap 2009-2010")
          
```
